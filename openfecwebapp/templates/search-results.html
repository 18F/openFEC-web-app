{% extends "layouts/main.html" %}
{% import 'macros/search.html' as search %}
{% import 'macros/page-header.html' as header %}

{% block title %}
    Search results
{% endblock %}

{% block body %}
{{ header.header(title) }}

<div class="main">
  <div class="container">
    <header>
      <h1 class="heading--main">Candidate and committee profiles</h1>
    </header>
    <form action="/" method="GET" class="slab slab--inline slab--neutral">
      <div class="container combo">
        <label for="search" class="label">Search candidate and committee profiles</label>
        <input id="search"
              name="search"
              value="{{ query }}"
              class="combo__input js-search-input"
              autocorrect="off"
              autocapitalize="off"
              spellcheck="false">
        <button name="commit" type="submit" class="button--cta combo__button button--search"><span class="u-visually-hidden">Search</span></button>
      </div>
    </form>
    <div class="row">
      <div class="sidebar-container sidebar-container--left">
        <nav class="sidebar sidebar--neutral side-nav js-sticky-side" data-sticky-container="main">
          <ul class="sidebar__content">
            <li class="side-nav__item">
                <a class="side-nav__link" href="#candidates">Candidates ({{results.candidates.pagination.count}})</a>
            </li>
            <li class="side-nav__item">
                <a class="side-nav__link" href="#committees">Committees ({{results.committees.pagination.count}})</a>
            </li>
          </ul>
        </nav>
      </div>
      <div class="main__content--right">
        {% if results %}
        <section class="option" id="candidates">
          <div class="row">
            <h2 class="u-no-margin u-float-left">Candidate results</h2>
            <div class="u-float-right">
              <span class="t-sans">{{ results.candidates.pagination.count }} total results
                {% if results.candidates.pagination.count > 5 %}| <a href="{{ url_for('candidates', q=query)}}">View more</a>{% endif %}
              </span>
            </div>
          </div>
          <ul>
          {% with candidates=results['candidates']['results'] %}
            {% for result in candidates %}
            <li class="post">
              <h3><i class="icon icon--inline--left i-candidate"></i><a href="{{ url_for('candidate_page', c_id=result.candidate_id) }}">{{ result.name }}</a></h3>
              <div class="post__preview t-sans">
                <span class="entity__type">Candidate for {{ result.office_full }}</span>
                {% if result.office != 'P' %}<span class="entity__type"> {{ result.state }} {% if result.office == 'H' %} - District {{ result.district }} {% endif %} </span>{% endif %}
                <span class="entity__type">{{ result.party_full }}</span>
                ID: {{ result.candidate_id }}
              </div>
            </li>
            {% endfor %}
          {% endwith %}
          </ul>
        </section>
        <section class="option" id="committees">
          <div class="row">
            <h2 class="u-no-margin u-float-left">Committee results</h2>
            <div class="u-float-right">
              <span class="t-sans">{{ results.committees.pagination.count }} total results
                {% if results.committees.pagination.count > 5 %}| <a href="{{ url_for('committees', q=query)}}">View more</a>{% endif %}
              </span>
            </div>
          </div>
          <ul>
          {% with committees=results.committees.results %}
            {% for result in committees %}
            <li class="post">
              <h3><i class="icon icon--inline--left i-committee"></i><a href="{{ url_for('committee_page', c_id=result.committee_id) }}">{{ result.name }}</a></h3>
              <div class="post__preview t-sans">
                <span class="entity__type">{{ result.committee_type_full }}</span>
                <span class="entity__type">{{ result.designation_full }}</span>
                ID: {{ result.committee_id }}
              </div>
            </li>
            {% endfor %}
          {% endwith %}
          </ul>
        </section>
        {% endif %}
      </div>
    </div>
</div>

{% endblock %}
