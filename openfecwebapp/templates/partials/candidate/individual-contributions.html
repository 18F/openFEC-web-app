{% import 'macros/missing.html' as missing %}
{% import 'macros/null.html' as null %}
{% import 'macros/cycle-select.html' as select %}

<section id="section-4" role="tabpanel" aria-hidden="true" aria-labelledby="section-4-heading">
  <div class="heading--section">
    <h2 id="section-4-heading">Individual Contributions</h2>
  </div>

  <div class="content__section">
    {{ select.cycle_select(election_years, cycle, duration=duration, id="cycle-1") }}
  </div>

  <span class="t-sans t-bold">Data is included from these committees:</span>
  <ul class="list--bulleted">
    {% for committee in committee_groups['P'] | reverse %}
    <li>
      <a class="t-sans" href="{{ url_for('committee_page', c_id=committee.committee_id, cycle=cycle) }}">{{ committee.name }}</a>
    </li>
    {% endfor %}
  </ul>
    <div class="results-info results-info--simple">
      <div class="row">
        <fieldset class="toggles u-float-left">
          <legend class="label">Group by:</legend>
          <label for="toggle-state">
            <input id="toggle-state" type="radio" class="panel-toggle-control" name="individual-contributions" value="contributor-state" checked />
            <span class="button--alt">Contributor state</span>
          </label>
          <label for="toggle-size">
            <input id="toggle-size" type="radio" class="panel-toggle-control" name="individual-contributions" value="contribution-size" />
            <span class="button--alt">Contribution size</span>
          </label>
          <label for="toggle-all">
            <input id="toggle-all" type="radio" class="panel-toggle-control" name="individual-contributions" value="all-transactions" />
            <span class="button--alt">All transactions</span>
          </label>
        </fieldset>
      </div>

    <div id="contributor-state" class="panel-toggle-element">
      <div class="results-info results-info--simple">
        <h3 class="results-info__title">Individual contributions by state</h3>
        <button type="button" class="js-export button button--cta button--export" data-export-for="contributor-state">Export</button>
      </div>
      <div class="map-table">
        <table
            class="data-table data-table--heading-borders"
            data-type="contributor-state"
            data-cycle="{{ cycle }}"
          >
          <thead>
            <th scope="col">State</th>
            <th scope="col">Total contributed</th>
          </thead>
        </table>
      </div>
      <div class="map-panel">
        <div class="state-map" data-committee-id="{% for c in committee_groups['P'] | reverse %}{{ c.committee_id }}{% if not loop.last %},{% endif %}{% endfor %}" data-cycle="{{ cycle }}">
          <div class="legend-container">
            <span class="t-sans t-block">By state: total amount received</span>
            <svg></svg>
          </div>
        </div>
      </div>
    </div>

    <div id="contribution-size" class="panel-toggle-element" aria-hidden="true">
      <div class="results-info results-info--simple">
        <h3 class="results-info__title">Receipts by size</h3>
        <button type="button" class="js-export button button--cta button--export" data-export-for="contribution-size">Export</button>
      </div>
      <table
         class="data-table data-table--heading-borders"
         data-type="contribution-size"
         data-cycle="{{ cycle }}">
        <thead>
          <th scope="col">Contribution size</th>
          <th scope="col">Total contributed</th>
        </thead>
      </table>
    </div>

    <div id="all-transactions" class="panel-toggle-element" aria-hidden="true">
      <div class="results-info results-info--simple">
        <h3 class="results-info__title">Individual contributions by transaction</h3>
        <button type="button" class="js-export button button--cta button--export" data-export-for="individual-contributions">Export</button>
      </div>
      <table
          class="data-table data-table--heading-borders"
          data-type="individual-contributions"
          data-candidate-id="{{ candidate_id }}"
          data-committee-id="{% for c in committee_groups['P'] | reverse %}{{ c.committee_id }}{% if not loop.last %},{% endif %}{% endfor %}"
          data-name="{{ name }}"
          data-cycle="{{ cycle }}"
        >
        <thead>
          <tr>
            <th scope="col">Contributor name</th>
            <th scope="col">Recipient</th>
            <th scope="col">Receipt date</th>
            <th scope="col">Amount</th>
          </tr>
        </thead>
      </table>
    </div>

  </div>

</section>
