{% extends "layouts/main.html" %}

{% block title %}
    Search results for "{{query}}"
{% endblock %}

{% block header %}
    {% include 'partials/page-nav.html' %}
{% endblock %}

{% block body %}
<div class="container">
  <section class="data page-section">
    <h2 class="tst-search_results">Search results
      {% if query %}
        <span class="text--query">{{query}}</span>
      {% endif %}
    </h2>

    {% if no_results %}
      <h4>Sorry, no results</h4>
    {% else %}
      <div class="results-header">
        <h3>{{ result_type[:-1]|capitalize }} Results</h3>
        <a href="{{ result_type }}?q={{query}}"
            class="button"
            data-category="candidates" data-query="{{query}}">View all</a>
      </div>
      <div class="page-subsection chunk--two-thirds">

        {% if result_type == 'committees' %}
          {% with committees=results %}
            {% for committee in committees %}
              <div class="box">
                {% include 'partials/search-results-committee.html' %}
              </div>
            {% endfor %}


          {% endwith %}
        {% else %}
          {% with candidates=results %}
            {% for candidate in candidates %}
              <div class="box">
                <div class="box__header">
                  <span class="text--medium">
                    Active: {{ candidate.active_through }}</span>
                  <span class="text--medium color-activity box__right">
                    Currently active (TODO)</span>
                </div>
                {% include 'partials/search-results-candidate.html' %}
                {% if candidate.committee %}
                {% with committee=candidate.committee %}
                  {% include "partials/search-results-committee.html" %}
                {% endwith %}
                {% endif %}
              </div>
            {% endfor %}
          {% endwith %}
        {% endif %}

      </div>
      <div class="page-subsection chunk--third">
        <div class="box">
          <div class="box__portion">
            <h5 class="box__title">Explore Candidates</h5>
            <p>Trying to sort through a lot of results? Or want to explore
              similar candidates? Try exploring all candidates.
            </p>
            <p>
              <a href="{{ url_for('candidates', name=query) }}">
                Refine search&amp;  filter results &twoheadrightarrow;
              </a>
            </p>
            <p>
              <a href="{{ url_for('committees') }}">
                View all current candidates &twoheadrightarrow;
              </a>
            </p>
          </div>
        </div>

        <div class="box">
          <div class="box__portion">
            <h5 class="box__title">Explore Committees</h5>
            <p>Looking for campaign organizations like campaign committees or
              Super PACs? Try exploring committees.
            </p>
            <p>
              <a href="{{ url_for('committees', name=query) }}">
                Search for committees named "{{ query }}"
              </a>
            </p>
            <hr></hr>
            <p><em>
              Looking for committees related to a certain candidate? View the
              candidate's page to see them all.
            </em></p>
          </div>
        </div>
      </div>
    {% endif %}
  </section>
</div>
{% endblock %}
