{% extends "layouts/main.html" %}

{% block title %}
    Search results for "{{query}}"
{% endblock %}

{% block header %}
    {% include 'partials/page-nav.html' %}
{% endblock %}

{% block body %}
<div class="container">
  <section class="data page-section">
    <h2 class="tst-search_results">Search results
      {% if query %}
        <span class="text--query">{{query}}</span>
      {% endif %}
    </h2>

    {% if no_results %}
      <h4>Sorry, no results</h4>
    {% else %}
      <div class="page-subsection">
        <div class="results-header">
          <h3>{{ result_type[:-1]|capitalize }} Results</h3>
          <a href="{{ result_type }}?q={{query}}"
              class="button"
              data-category="candidates" data-query="{{query}}">View all</a>
        </div>
        {% if result_type == 'committees' %}
          {% with committees=results %}
            {% for committee in committees %}
              {% include 'partials/search-results-committee.html' %}
              <div class="figure-group">
                {% if committee.candidate %}
                {% with candidate = committe.candidate %}
                  {% include "partials/search-results-candidate.html" %}
                {% endwith %}
                {% endif %}
              </div>
            {% endfor %}


          {% endwith %}
        {% else %}
          {% with candidates=results %}
            {% for candidate in candidates %}
              <div class="figure-group__header--short">
                <span>Active: {{ candidate.active_through }}</span>
                <span class="u-float-right color-activity">
                  Currently active (TODO)</span>
              </div>
              {% include 'partials/search-results-candidate.html' %}
              <div class="figure-group">
                {% if candidate.committee %}
                {% with committee=candidate.committee %}
                  {% include "partials/search-results-committee.html" %}
                {% endwith %}
                {% endif %}
              </div>
            {% endfor %}
          {% endwith %}
        {% endif %}
      </div>
    {% endif %}
  </section>
</div>
{% endblock %}
